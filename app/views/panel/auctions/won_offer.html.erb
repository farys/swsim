<% content_for :title, 'Wybieranie zwyciężcy' %>
<h1 class="headField">Wybieranie zwyciężcy</h1>

<div class="standardField" style="width:900px;padding:30px;margin: 10px auto">
<% form_for [:update_won_offer, @auction] do |f| %>

<%= render "layouts/error_messages", :target => @auction %>

  <%= f.label :won_offer_id, 'Która oferta zwycięża ?' %><br /><br />
  <table>
    <thead>
    <tr class="headField">
      <td>wybór</td>
      <td>kwota</td>
      <td>czas</td>
      <td>wykonawca</td>
      <td>etap</td>
      <td>data</td>
    </tr>
  </thead>
  <tbody>
    <% i = 0 %>
      <% @auction.offers.latest.each do |offer| %>
    <% i += 1 %>
    <% html = case
    when offer.status == Offer::STATUS_REJECTED
      'rejected'
    when i%2 < 1
      'cycle'
    end
      %>
        <tr<% unless html.nil? %> class="<%= html %>"<% end %>>
          <td><% if [Offer::STATUS_ACTIVE, Offer::STATUS_LATEST].include?(offer.status) %><%= radio_button :auction, :won_offer_id, offer.id %><% end %></td>
          <td style="font-weight:bold"><%= offer.price %> zł</td>
          <td><%= offer.days %> dni</td>
          <td style="text-align: center">
            <% unless nil %><img style="width:50px; height: 50px" src="/images/avatar.jpg" /><% end %>
          <%= offer.offerer.name %>
          </td>
          <td><%= offer.stage %></td>
          <td><%=raw escape_time(offer.created_at) %></td>
        </tr>
<% end %>
  </tbody>
</table>
<%= f.submit "Wybierz" %>
<% end %>
</div>